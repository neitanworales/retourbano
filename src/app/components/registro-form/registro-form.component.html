<form (ngSubmit)="onSubmit()" [formGroup]="registerForm">
    <div class="row">
        <div *ngIf="saveInMemory" class="col">
            <h2 class="text-center">Datos del tutor</h2>
            <div *ngIf="saveInMemory">
                <div class="form-group">
                    <label>Nombre de tutor</label>
                    <input type="text" class="form-control" formControlName="tutorNombre"
                        placeholder="¿A quién conctactamos en caso de accidente?"
                        [ngClass]="{'is-invalid': form['tutorNombre'].errors }" [(ngModel)]="model.tutorNombre" />
                    <div *ngIf="form['tutorNombre'].errors" class="invalid-feedback">
                        <div *ngIf="form['tutorNombre'].errors">El nombre es obligatorio</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Teléfono del tutor</label>
                    <input type="text" class="form-control" formControlName="tutorTelefono"
                        placeholder="Escribe Escribe el telefono de tu tutor"
                        [ngClass]="{'is-invalid': form['tutorTelefono'].errors }" [(ngModel)]="model.tutorTelefono" />
                    <div *ngIf="form['tutorTelefono'].errors" class="invalid-feedback">
                        <div *ngIf="form['tutorTelefono'].errors">El teléfono de tu tutor es obligatorio</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>E-mail del tutor</label>
                    <input type="email" class="form-control" formControlName="email" placeholder="Escribe tu e-mail"
                        [ngClass]="{'is-invalid': form['email'].errors }" [(ngModel)]="model.email" />
                    <div *ngIf="form['email'].errors" class="invalid-feedback">
                        <div *ngIf="form['email'].errors">El e-mail es obligatorio</div>
                    </div>
                </div>
            </div>

            <h2>Agregados para registrar</h2>
            <div class="list-group lista-memory">
                <h3 *ngIf="paraRegistrar.length==0">No has agregado a nadie para registrar</h3>
                <a *ngFor="let guerrero of paraRegistrar; index as i; first as isFirst"
                    class="list-group-item list-group-item-action">
                    {{i+1}} <i class="bi bi-person-fill"></i> {{guerrero.nick}} - {{guerrero.sexo}} -
                    {{guerrero.nombre}}
                    <span class="right"><a (click)="quitarDeLaLista(i)"><i class="bi bi-trash"></i></a></span>
                </a>
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <button *ngIf="paraRegistrar.length>0" class="btn btn-success" (click)="registrarBatch()"><i
                            class="bi bi-send-fill"></i> Enviar</button>
                </div>
                <div class="col-lg-6">

                </div>
            </div>
        </div>
        <div class="col">
            <h2 class="text-center">Formulario de Registro</h2>
            <div class="form-group">
                <label>Nombre completo</label>
                <input type="text" class="form-control" formControlName="nombre" placeholder="Escribe tu nombre"
                    [ngClass]="{'is-invalid': form['nombre'].errors }" [(ngModel)]="model.nombre" />
                <div *ngIf="form['nombre'].errors" class="invalid-feedback">
                    <div *ngIf="form['nombre'].errors">El nombre es obligatorio</div>
                </div>
            </div>
            <div class="form-group">
                <label>Nick (para tu gafete)</label>
                <input type="text" class="form-control" formControlName="nick" placeholder="Escribe tu nick"
                    [ngClass]="{'is-invalid': form['nick'].errors }" [(ngModel)]="model.nick" />
                <div *ngIf="form['nick'].errors" class="invalid-feedback">
                    <div *ngIf="form['nick'].errors">El nick es obligatorio</div>
                </div>
            </div>

            <div class="form-group">
                <label for="nombre">Año de nacimiento</label>
                <select class="form-control" formControlName="year" [(ngModel)]="model.year"
                    [ngClass]="{'is-invalid': form['year'].errors }" (change)="this.calculateEdad()">
                    <option value="0" disabled="true" selected="true">Selecciona tu año</option>

                    <option value="2011">2011</option>
                    
                    <option value="2010">2010</option>
                    <option value="2009">2009</option>
                    <option value="2008">2008</option>
                    <option value="2007">2007</option>
                    <option value="2006">2006</option>
                    <option value="2005">2005</option>
                    <option value="2004">2004</option>
                    <option value="2003">2003</option>
                    <option value="2002">2002</option>
                    <option value="2001">2001</option>
                    <option value="2000">2000</option>

                    <option value="1999">1999</option>
                    <option value="1998">1998</option>
                    <option value="1997">1997</option>
                    <option value="1996">1996</option>
                    <option value="1995">1995</option>
                    <option value="1994">1994</option>
                    <option value="1993">1993</option>
                    <option value="1992">1992</option>
                    <option value="1991">1991</option>
                    <option value="1990">1990</option>

                    <option value="1989">1989</option>
                    <option value="1988">1988</option>
                    <option value="1987">1987</option>
                    <option value="1986">1986</option>
                    <option value="1985">1985</option>
                    <option value="1984">1984</option>
                    <option value="1983">1983</option>
                    <option value="1982">1982</option>
                    <option value="1981">1981</option>
                    <option value="1980">1980</option>

                    <option value="1979">1979</option>
                    <option value="1978">1978</option>
                    <option value="1977">1977</option>
                    <option value="1976">1976</option>
                    <option value="1975">1975</option>
                    <option value="1974">1974</option>
                    <option value="1973">1973</option>
                    <option value="1972">1972</option>
                    <option value="1971">1971</option>
                    <option value="1970">1970</option>

                    <option value="1969">1969</option>
                    <option value="1968">1968</option>
                    <option value="1967">1967</option>
                    <option value="1966">1966</option>
                    <option value="1965">1965</option>
                    <option value="1964">1964</option>
                    <option value="1963">1963</option>
                    <option value="1962">1962</option>
                    <option value="1961">1961</option>
                    <option value="1960">1960</option>

                    <option value="1959">1959</option>
                    <option value="1958">1958</option>
                    <option value="1957">1957</option>
                    <option value="1956">1956</option>
                    <option value="1955">1955</option>
                    <option value="1954">1954</option>
                    <option value="1953">1953</option>
                    <option value="1952">1952</option>
                    <option value="1951">1951</option>
                    <option value="1950">1950</option>

                    <option value="1949">1949</option>
                    <option value="1948">1948</option>
                    <option value="1947">1947</option>
                    <option value="1946">1946</option>
                    <option value="1945">1945</option>
                    <option value="1944">1944</option>
                    <option value="1943">1943</option>
                    <option value="1942">1942</option>
                    <option value="1941">1941</option>
                    <option value="1940">1940</option>

                    <option value="1940">1939</option>
                </select>
                <div *ngIf="form['year'].errors" class="invalid-feedback">
                    <div *ngIf="form['year'].errors">Tu año de nacimiento es obligatorio</div>
                </div>
            </div>

            <div class="form-group">
                <label for="nombre">Mes de nacimiento</label>
                <select class="form-control" formControlName="month" [(ngModel)]="model.month"
                    [ngClass]="{'is-invalid': form['month'].errors }" (change)="this.calculateEdad()">
                    <option value="0" disabled="true" selected="true">Selecciona tu mes</option>
                    <option value="1">Enero</option>
                    <option value="2">Febrero</option>
                    <option value="3">Marzo</option>
                    <option value="4">Abril</option>
                    <option value="5">Mayo</option>
                    <option value="6">Junio</option>
                    <option value="7">Julio</option>
                    <option value="8">Agosto</option>
                    <option value="9">Septiembre</option>
                    <option value="10">Octubre</option>
                    <option value="11">Noviembre</option>
                    <option value="12">Diciembre</option>
                </select>
                <div *ngIf="form['month'].errors" class="invalid-feedback">
                    <div *ngIf="form['month'].errors">Tu mes de nacimiento es obligatorio</div>
                </div>
            </div>

            <div class="form-group">
                <label for="nombre">Día de nacimiento</label>
                <select class="form-control" formControlName="day" [(ngModel)]="model.day"
                    [ngClass]="{'is-invalid': form['day'].errors }" (change)="this.calculateEdad()">
                    <option value="0" disabled="true" selected="true">Selecciona tu día</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                </select>
                <div *ngIf="form['day'].errors" class="invalid-feedback">
                    <div *ngIf="form['day'].errors">Tu día de nacimiento es obligatorio</div>
                </div>
            </div>

            <div class="form-group">
                <label for="nombre">Edad</label>
                <input class="form-control" placeholder="Edad" type="text" value={{model.edad}} id="edad" name="edad"
                    disabled />
            </div>
            <div class="form-group">
                <label>Selecciona tu sexo</label>
                <select class="form-control" formControlName="sexo" [ngClass]="{'is-invalid': form['sexo'].errors }"
                    [(ngModel)]="model.sexo">
                    <option value="" disabled="" selected="true">Selecciona tu sexo / Gender</option>
                    <option value="M">Hombre</option>
                    <option value="F">Mujer</option>
                </select>
                <div *ngIf="form['sexo'].errors" class="invalid-feedback">
                    <div *ngIf="form['sexo'].errors">Selecciona tu sexo</div>
                </div>
            </div>
            <div class="form-group">
                <label>Selecciona tu talla</label>
                <select class="form-control" formControlName="talla" [ngClass]="{'is-invalid': form['talla'].errors }"
                    [(ngModel)]="model.talla">
                    <option value="" disabled="" selected="">Talla de playera / T-shirt size</option>
                    <option value="XS">Extra-Chica / XS</option>
                    <option value="S">Chica / X</option>
                    <option value="M">Mediana / M</option>
                    <option value="X">Grande / X</option>
                    <option value="XL">Extra-Grande / XL</option>
                    <option value="XXL">2XL / XXL</option>
                </select>
                <div *ngIf="form['talla'].errors" class="invalid-feedback">
                    <div *ngIf="form['talla'].errors">La talla es obligatoria</div>
                </div>
            </div>
            <div class="form-group">
                <label>¿De donde vienes?</label>
                <input type="text" class="form-control" formControlName="vienesDe"
                    placeholder="Escribe tu lugar de procedencia (CDMX, Pachuca, Huston, etc...)"
                    [ngClass]="{'is-invalid': form['vienesDe'].errors }" [(ngModel)]="model.vienesDe" />
                <div *ngIf="form['vienesDe'].errors" class="invalid-feedback">
                    <div *ngIf="form['vienesDe'].errors">Esta dato es obligatorio</div>
                </div>
            </div>
            <div class="form-group">
                <label>¿Tienes alergias?</label>
                <input type="text" class="form-control" placeholder="Si tienes alergias escribe cuales"
                    [(ngModel)]="model.alergias" [ngModelOptions]="{standalone: true}" />
            </div>
            <div class="form-group">
                <label>¿Estás tomando algún medicamento? Cuéntanos mas</label>
                <input type="text" class="form-control" placeholder="Describe el tratamiento"
                    [(ngModel)]="model.medicamentos" [ngModelOptions]="{standalone: true}" />
            </div>
            <div class="form-group">
                <label>¿Por que vienes a Reto Urbano?</label>
                <input type="text" class="form-control" formControlName="razones" placeholder="Escribe tus motivos"
                    [ngClass]="{'is-invalid': form['razones'].errors }" [(ngModel)]="model.razones" />
                <div *ngIf="form['razones'].errors" class="invalid-feedback">
                    <div *ngIf="form['razones'].errors">Este campo es necesario</div>
                </div>
            </div>


            <div class="form-group">
                <label>En caso de que asistas a una iglesia, escribe su nombre</label>
                <input type="text" class="form-control" placeholder="Escribe el nombre de tu iglesia"
                    [(ngModel)]="model.iglesia" [ngModelOptions]="{standalone: true}" />
            </div>
            <div *ngIf="!saveInMemory" class="form-group">
                <label>Tu e-mail</label>
                <input type="email" class="form-control" formControlName="email" placeholder="Escribe tu e-mail"
                    [ngClass]="{'is-invalid': form['email'].errors }" [(ngModel)]="model.email" />
                <div *ngIf="form['email'].errors" class="invalid-feedback">
                    <div *ngIf="form['email'].errors">El e-mail es obligatorio</div>
                </div>
            </div>
            <div class="form-group">
                <label>¿Tienes Whatsapp?</label>
                <input type="text" class="form-control" formControlName="whatsapp" placeholder="Escribe tu Whatsapp"
                    [(ngModel)]="model.whatsapp" />
            </div>
            <div class="form-group">
                <label>¿Tienes teléfono?</label>
                <input type="text" class="form-control" formControlName="telefono"
                    placeholder="Escribe tu número de teléfono" [ngClass]="{'is-invalid': form['telefono'].errors }"
                    [(ngModel)]="model.telefono" />
                <div *ngIf="form['telefono'].errors" class="invalid-feedback">
                    <div *ngIf="form['telefono'].errors">Este dato es obligatorio</div>
                </div>
            </div>
            <div class="form-group">
                <label>Facebook</label>
                <input type="text" class="form-control" placeholder="Como te encontramos en facebook"
                    [(ngModel)]="model.facebook" [ngModelOptions]="{standalone: true}" />
            </div>
            <div class="form-group">
                <label>Instagram</label>
                <input type="text" class="form-control" placeholder="Como te encontramos en instagram"
                    [(ngModel)]="model.instagram" [ngModelOptions]="{standalone: true}" />
            </div>

            <div *ngIf="!saveInMemory">
                <h3>Datos del tutor</h3>
                <p>¿A quien conctactamos en caso de emergencia?</p>
                <div class="form-group">
                    <label>Nombre de tutor</label>
                    <input type="text" class="form-control" formControlName="tutorNombre"
                        placeholder="¿A quién conctactamos en caso de accidente?"
                        [ngClass]="{'is-invalid': form['tutorNombre'].errors }" [(ngModel)]="model.tutorNombre" />
                    <div *ngIf="form['tutorNombre'].errors" class="invalid-feedback">
                        <div *ngIf="form['tutorNombre'].errors">El nombre de tutor es obligatorio</div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Teléfono del tutor</label>
                    <input type="text" class="form-control" formControlName="tutorTelefono"
                        placeholder="Escribe Escribe el telefono de tu tutor"
                        [ngClass]="{'is-invalid': form['tutorTelefono'].errors }" [(ngModel)]="model.tutorTelefono" />
                    <div *ngIf="form['tutorTelefono'].errors" class="invalid-feedback">
                        <div *ngIf="form['tutorTelefono'].errors">El teléfono de tu tutor es obligatorio</div>
                    </div>
                </div>
            </div>

            <div class="form-check">
                <input type="checkbox" formControlName="aceptaPoliticas" placeholder="Escribe aceptaPoliticas"
                    [ngClass]="{'is-invalid': form['aceptaPoliticas'].errors }" [(ngModel)]="model.aceptaPoliticas" />
                <label>Aceptas los terminos y condiciones</label>
                <div *ngIf="form['aceptaPoliticas'].errors" class="invalid-feedback">
                    <div *ngIf="form['aceptaPoliticas'].errors">Es necesario aceptar los terminos y condiciones</div>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="actualizar; else elseBlock" class="row" style="margin-top: 2em; margin-bottom: 2em;">
        <button type="submit" class="btn btn-success">Guardar y Reinscribir</button>
    </div>
    <ng-template #elseBlock class="row" style="margin-top: 2em; margin-bottom: 2em;">
        <button type="submit" class="btn btn-success" [disabled]="registerForm.invalid">
            <i class="bi bi-plus-circle"></i>
            {{saveInMemory?"Agregar":"Inscribirte"}}</button>
    </ng-template>
    <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displayStyle}" aria-modal="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title">{{errorRegistro?'Error al registrar':'Registro correcto'}}</h1>
                </div>
                <div class="modal-body">
                    <div class="list-group lista-memory">
                        <a *ngFor="let mr of mensajesRegistros; index as i; first as isFirst"
                            class="list-group-item list-group-item-action">
                            <div *ngIf="this.errorRegistro; else elseBlock">
                                {{i+1}} <i class="bi bi-person-fill"></i> {{mr}}
                                <span class="right"><i class="bi bi-x-circle"></i></span>
                            </div>
                            <ng-template #elseBlock>
                                {{i+1}} <i class="bi bi-person-fill"></i> {{mr}}
                                <span class="right"><i class="bi bi-person-check-fill"></i></span>
                            </ng-template>
                        </a>
                    </div>
                    <p>
                        Revisa tu bandeja de correo electrónico (y spam) ya que nos estaremos poniendo en contacto
                        contigo y también te enviamos los datos de pago. La cuenta de correo es <b>reto&#64;ywampachuca.org</b>
                    </p>
                    <p>En el correo que te enviamos viene la información de pago para reservar tu lugar!!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal"
                        (click)="closePopup()">Cerrar/Close</button>
                </div>
            </div>
        </div>
    </div>
</form>